"use strict";var PDFDocument=require("pdfkit"),fs=require("fs"),db=require("../models");exports.downloadSK=function(n,t){var r,a,s,o,u,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.session.user.id,a=n.session.user,s=a.role,e.next=6,regeneratorRuntime.awrap(db.Pengajuan.findOne({where:{userId:r}}));case 6:return o=e.sent,e.next=9,regeneratorRuntime.awrap(db.SuratKeputusan.findAll({where:{pengajuanId:o.id},include:[{model:db.Pengajuan}]}));case 9:u=e.sent,t.render("user/suratkeputusan",{sks:u,title:"Surat Keputusan",userRole:s}),c=new PDFDocument,t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",'attachment; filename="SK-BSS-'.concat(user.name,'.pdf"')),c.pipe(t),c.fontSize(20).text("Surat Keputusan Berhenti Studi Sementara Tahun Ajaran 2024/2025 ".concat(o.fakultas),{align:"center"}),c.moveDown(.1),o.forEach(function(e,n){c.fontSize(12).text("".concat(n+1,". Nomor surat: ").concat(e.id)),c.text("   Nama: ".concat(e.name)),c.text("   Nim: ".concat(e.nim)),c.text("   SKS: ".concat(e.sks)),c.moveDown(.1)}),c.end(),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error("Error generating PDF:",e.t0),t.status(500).send("Internal Server Error");case 25:case"end":return e.stop()}},null,null,[[0,21]])};
//# sourceMappingURL=createSK.min.js.map
