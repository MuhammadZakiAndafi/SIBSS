"use strict";var db=require("../models"),PDFDocument=require("pdfkit"),fs=require("fs");exports.showSk=function(n,t){var r,a,s,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.session.user.id,a=n.session.user,s=a.role,e.next=6,regeneratorRuntime.awrap(db.Pengajuan.findOne({where:{userId:r}}));case 6:return u=e.sent,e.next=9,regeneratorRuntime.awrap(db.SuratKeputusan.findAll({where:{pengajuanId:u.id},include:[{model:db.Pengajuan}]}));case 9:o=e.sent,t.render("user/suratkeputusan",{sks:o,title:"Surat Keputusan",userRole:s}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching surat keputusan:",e.t0),t.status(500).send("Internal Server Error");case 17:case"end":return e.stop()}},null,null,[[0,13]])},exports.downloadSK=function(n,t){var r,a,s,u,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.session.user.id,a=n.session.user,s=a.role,e.next=5,regeneratorRuntime.awrap(db.Pengajuan.findOne({where:{userId:r}}));case 5:return u=e.sent,e.next=8,regeneratorRuntime.awrap(db.SuratKeputusan.findAll({where:{pengajuanId:u.id},include:[{model:db.Pengajuan}]}));case 8:o=e.sent,t.render("user/suratkeputusan",{sks:o,title:"Surat Keputusan",userRole:s}),i=new PDFDocument,t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",'attachment; filename="SK-BSS-'.concat(user.name,'.pdf"')),i.pipe(t),i.fontSize(20).text("Surat Keputusan Berhenti Studi Sementara Tahun Ajaran 2024/2025 ".concat(u.fakultas),{align:"center"}),i.moveDown(.1),u.forEach(function(e,n){i.fontSize(12).text("".concat(n+1,". Nomor surat: ").concat(e.id)),i.text("   Nama: ".concat(e.name)),i.text("   Nim: ".concat(e.nim)),i.text("   SKS: ".concat(e.sks)),i.moveDown(.1)}),i.end();case 18:case"end":return e.stop()}})};
//# sourceMappingURL=skController.min.js.map
